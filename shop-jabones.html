<!DOCTYPE html>
<html lang="en">
   <head>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <!-- mobile metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <!-- site metas -->
      <title>Healthy Vibes</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">
      <!-- bootstrap css -->
      <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
      <!-- style css -->
      <link rel="stylesheet" type="text/css" href="css/style.css">
      <!-- Responsive-->
      <link rel="stylesheet" href="css/responsive.css">
      <!-- fevicon -->
      <link rel="icon" href="images/fevicon.png" type="image/gif" />
      <!-- Scrollbar Custom CSS -->
      <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
      <!-- Tweaks for older IEs-->
      <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
      <!-- owl stylesheets --> 
      <link rel="stylesheet" href="css/owl.carousel.min.css">
      <link rel="stylesheet" href="css/owl.theme.default.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
   </head>
   <body>
      <!-- header section start -->
      <div class="header_section">
         <div class="container-fluid">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
               <div class="logo"><a href="index.html"><img class="logomain" src="images/logomain.jpg" alt=""></a></div>
               <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
               <span class="navbar-toggler-icon"></span>
               </button>
               <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav mr-auto">
                     <li class="nav-item">
                        <a class="nav-link" href="index.html">Inicio</a>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link" href="about.html">Sobre nosotros</a>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link" href="contact.html">Contacto</a>
                     </li>
                  </ul>
                  <div class="lOG-SP">
                     <ul>
                        <li><a href="Registro.html">REGISTRO</a></li>
                        <li><a href="login.html">INICIO DE SESION</a></li>
                     </ul>
                  </div>
               </div>
            </nav>
         </div>
      </div>
      <!-- header section end -->
      <!-- furnitures section start -->
      <script>
         document.addEventListener('DOMContentLoaded', () => {
           // Variables
           const baseDeDatos = [
               {
                  id: 1,
                  nombre:' 3 Jabones artesanales para uso corporal y facial  marca - Vital green',
                  precio: 279, 
                  imagen:'images/vital green.jpg'
               },
              
           ];
 
           let carrito = [];
           const divisa = '$';
           const DOMitems = document.querySelector('#items');
           const DOMcarrito = document.querySelector('#carrito');
           const DOMtotal = document.querySelector('#total');
           const DOMbotonVaciar = document.querySelector('#boton-vaciar');
 
           // Funciones
 
           /**
           * Dibuja todos los productos a partir de la base de datos. No confundir con el carrito
           */
           function renderizarProductos() {
               baseDeDatos.forEach((info) => {
                   // Estructura
                   const miNodo = document.createElement('div');
                   miNodo.classList.add('card', 'col-sm-4');
                   // Body
                   const miNodoCardBody = document.createElement('div');
                   miNodoCardBody.classList.add('card-body');
                   // Titulo
                   const miNodoTitle = document.createElement('h5');
                   miNodoTitle.classList.add('card-title');
                   miNodoTitle.textContent = info.nombre;
                   // Imagen
                   const miNodoImagen = document.createElement('img');
                   miNodoImagen.classList.add('img-fluid');
                   miNodoImagen.setAttribute('src', info.imagen);
                   // Precio
                   const miNodoPrecio = document.createElement('p');
                   miNodoPrecio.classList.add('card-text');
                   miNodoPrecio.textContent = `${divisa}${info.precio}`;
                   // Boton 
                   const miNodoBoton = document.createElement('button');
                   miNodoBoton.classList.add('btn', 'btn-primary');
                   miNodoBoton.textContent = '+';
                   miNodoBoton.setAttribute('marcador', info.id);
                   miNodoBoton.addEventListener('click', anyadirProductoAlCarrito);
                   // Insertamos
                   miNodoCardBody.appendChild(miNodoImagen);
                   miNodoCardBody.appendChild(miNodoTitle);
                   miNodoCardBody.appendChild(miNodoPrecio);
                   miNodoCardBody.appendChild(miNodoBoton);
                   miNodo.appendChild(miNodoCardBody);
                   DOMitems.appendChild(miNodo);
               });
           }
 
           /**
           * Evento para añadir un producto al carrito de la compra
           */
           function anyadirProductoAlCarrito(evento) {
               // Anyadimos el Nodo a nuestro carrito
               carrito.push(evento.target.getAttribute('marcador'))
               // Actualizamos el carrito 
               renderizarCarrito();
 
           }
 
           /**
           * Dibuja todos los productos guardados en el carrito
           */
           function renderizarCarrito() {
               // Vaciamos todo el html
               DOMcarrito.textContent = '';
               // Quitamos los duplicados
               const carritoSinDuplicados = [...new Set(carrito)];
               // Generamos los Nodos a partir de carrito
               carritoSinDuplicados.forEach((item) => {
                   // Obtenemos el item que necesitamos de la variable base de datos
                   const miItem = baseDeDatos.filter((itemBaseDatos) => {
                       // ¿Coincide las id? Solo puede existir un caso
                       return itemBaseDatos.id === parseInt(item);
                   });
                   // Cuenta el número de veces que se repite el producto
                   const numeroUnidadesItem = carrito.reduce((total, itemId) => {
                       // ¿Coincide las id? Incremento el contador, en caso contrario no mantengo
                       return itemId === item ? total += 1 : total;
                   }, 0);
                   // Creamos el nodo del item del carrito
                   const miNodo = document.createElement('li');
                   miNodo.classList.add('list-group-item', 'text-right', 'mx-2');
                   miNodo.textContent = `${numeroUnidadesItem} x ${miItem[0].nombre} - ${miItem[0].precio}${divisa}`;
                   // Boton de borrar
                   const miBoton = document.createElement('button');
                   miBoton.classList.add('btn', 'btn-danger', 'mx-5');
                   miBoton.textContent = 'X';
                   miBoton.style.marginLeft = '1rem';
                   miBoton.dataset.item = item;
                   miBoton.addEventListener('click', borrarItemCarrito);
                   // Mezclamos nodos
                   miNodo.appendChild(miBoton);
                   DOMcarrito.appendChild(miNodo);
               });
              // Renderizamos el precio total en el HTML
              DOMtotal.textContent = calcularTotal();
           }
 
           /**
           * Evento para borrar un elemento del carrito
           */
           function borrarItemCarrito(evento) {
               // Obtenemos el producto ID que hay en el boton pulsado
               const id = evento.target.dataset.item;
               // Borramos todos los productos
               carrito = carrito.filter((carritoId) => {
                   return carritoId !== id;
               });
               // volvemos a renderizar
               renderizarCarrito();
           }
 
           /**
            * Calcula el precio total teniendo en cuenta los productos repetidos
            */
           function calcularTotal() {
               // Recorremos el array del carrito 
               return carrito.reduce((total, item) => {
                   // De cada elemento obtenemos su precio
                   const miItem = baseDeDatos.filter((itemBaseDatos) => {
                       return itemBaseDatos.id === parseInt(item);
                   });
                   // Los sumamos al total
                   return total + miItem[0].precio;
               }, 0).toFixed(2);
           }
 
           /**
           * Varia el carrito y vuelve a dibujarlo
           */
           function vaciarCarrito() {
               // Limpiamos los productos guardados
               carrito = [];
               // Renderizamos los cambios
               renderizarCarrito();
           }
 
           // Eventos
           DOMbotonVaciar.addEventListener('click', vaciarCarrito);
 
           // Inicio
           renderizarProductos();
           renderizarCarrito();
         });
     </script>
 </head>
 <body>
     <div class="container">
         <div class="row">
             <!-- Elementos generados a partir del JSON -->
             <main id="items" class="col-sm-8 row"></main>
             <!-- Carrito -->
             <aside class="col-sm-4">
                 <h2>Carrito</h2>
                 <!-- Elementos del carrito -->
                 <ul id="carrito" class="list-group"></ul>
                 <hr>
                 <!-- Precio total -->
                 <p class="text-right">Total: <span id="total"></span&dollar;;</p>
                  <p><b class="pago"><a href="pago.html">PAGAR</a></b></p>
                 <button id="boton-vaciar" class="btn btn-danger">Vaciar</button>
             </aside>
         </div>
     </div>
 </body>
      <!-- furnitures section end -->
   <!-- footer section start -->
   <div class="footer_section layout_padding">
      <div class="container">
         <div class="row">
           
            
            <div class="col-lg-3 col-sm-6">
               <h1 class="customer_text">INFORMATION</h1>
               <p class="footer_lorem_text1">About Us<br>
                  Careers<br>
                  Press & News<br>
                  Competitions<br>
                  Terms & Conditions
               </p>
            </div>
           
         </div>
         <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="Enter your email" aria-label="Enter your email" aria-describedby="basic-addon2">
            <div class="input-group-append">
               <span class="input-group-text" id="basic-addon2"><a href="#">Subscribe</a></span>
            </div>
         </div>
      </div>
   </div>
   <!--  footer section end -->
   <!-- copyright section start -->
   <div class="copyright_section">
   <div class="container">
      <div class="social_icon">
         <ul>
            <li><a href="https://www.facebook.com/profile.php?id=100079091512234&mibextid=ZbWKwL"><img src="images/fb-icon.png"></a></li>
            <li><a href="#"><img src="images/twitter-icon.png"></a></li>
            <li><a href="https://www.instagram.com/hi_healthyvibes/"><img src="images/instagram-icon.png"></a></li>
         </ul>
      </div>
      <p class="copyright_text">2022 All Rights Reserved. Design by Healthy vibes S.A de C.V
   </div>
   <!-- copyright section end -->
   <!-- Javascript files-->
   <script src="js/jquery.min.js"></script>
   <script src="js/popper.min.js"></script>
   <script src="js/bootstrap.bundle.min.js"></script>
   <script src="js/jquery-3.0.0.min.js"></script>
   <script src="js/plugin.js"></script>
   <!-- sidebar -->
   <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
   <script src="js/custom.js"></script>
   <!-- javascript --> 
   <script src="js/owl.carousel.js"></script>
   <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>    
</body>
</html>